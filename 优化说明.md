# 洗炼助手优化说明

## 优化时间
2026年1月28日

## 优化内容

### 1. 简化坐标配置流程
**之前**：需要配置4个点
- 装备位置（1个点）
- 词缀区域（2个点：左上角、右下角）
- 洗炼按钮位置（1个点）

**现在**：只需配置3个点
- 装备位置（1个点）
- 词缀区域（2个点：左上角、右下角）
- ~~洗炼按钮位置~~（已移除）

### 2. 优化操作流程
**之前的流程**：
1. 鼠标移动到装备位置
2. 读取词缀区域
3. 判断是否合格
4. 如果不合格：鼠标移动到洗炼按钮 → 点击
5. 重复

**现在的流程**：
1. 鼠标移动到装备位置并停留
2. 读取词缀区域
3. 判断是否合格
4. 如果不合格：**直接按Z键**（鼠标不移动）
5. 重复

### 3. 优势分析

✅ **更快速**：省去了鼠标移动到按钮的时间
✅ **更稳定**：鼠标保持在固定位置，减少误操作
✅ **更简单**：配置时少记录一个坐标点
✅ **更灵活**：适应不同游戏界面布局

## 修改的文件

### 核心文件
1. **src/gear_washer/washer.py**
   - `calibrate_ui()`: 移除了洗炼按钮坐标的记录步骤
   - `run()`: 使用`keyboard.press_and_release('z')`或`pyautogui.press('z')`代替鼠标点击
   - 移除了`wash_button_pos`的验证检查

2. **run_washer_v2.py**
   - 移除了保存和加载洗炼按钮位置的所有逻辑
   - 简化了配置流程

3. **gui.py**
   - 移除了洗炼按钮坐标的保存和加载
   - 简化了装备配置流程

4. **README.md**
   - 更新了使用说明，反映新的简化流程

### 数据库结构
- 数据库结构本身已经是简化的，不包含wash_button字段
- 移除了代码中对`global_wash_button_pos`的所有引用

## 使用注意事项

⚠️ **重要**：游戏内必须将洗炼功能绑定到**Z键**
- 如果游戏使用其他按键，请修改`washer.py`中的按键设置
- 位置在第237行左右：`keyboard.press_and_release('z')`

## 兼容性
- 所有现有的词缀配置完全兼容
- 旧的装备配置也兼容（只是不再需要按钮坐标）
- 建议重新定位装备配置以获得最佳体验

## 测试建议
1. 先用【新建】功能创建一个测试装备配置
2. 验证坐标记录是否正常（只需3个点）
3. 选择一个简单的词缀规则测试
4. 确认Z键能正常触发洗炼
5. 观察鼠标是否保持在装备位置

## 后续可能的优化方向
- [ ] 支持自定义洗炼快捷键
- [ ] 添加洗炼速度调节（间隔时间）
- [ ] 支持批量洗炼多个装备
- [ ] 添加洗炼统计功能（尝试次数、成功率等）
