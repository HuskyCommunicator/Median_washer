# 洗炼助手 Pro (MedianWasher Pro) - 操作手册 v2.0

## 📖 产品简介
**洗炼助手 Pro** 是一款专为《暗黑破坏神2》及其模组（如 Median XL Sigma）设计的智能装备洗炼工具。它利用先进的 OCR 视觉识别技术，实时监控装备属性变化，并根据您设定的复杂规则自动执行洗炼操作，直到获得心仪的装备属性。

与传统按键精灵不同，本工具**不读取内存**，完全基于屏幕图像识别，安全且通用性强。

---

## 🔥 核心功能
*   **👁️ 视觉智能识别**：支持中英文、数字混合识别，自适应游戏字体。
*   **🎯 精准定位系统**：独创的“三步校准法”，轻松适配不同分辨率和窗口位置。
*   **⚙️ 强大规则引擎**：
    *   **简单模式**：仅需输入关键词即可筛选。
    *   **高级模式**：支持多条件组合（例如：“力量 > 50 且 技能等级 >= 2”）。
    *   **逻辑运算**：支持“并且(AND)”、“或者(OR)”、“数量统计(COUNT)”等逻辑。
*   **💾 多配置管理**：支持保存多套装备位置方案和多套洗炼规则，通过名称快速切换。
*   **⌨️ 全局快捷键**：一键启动/停止，后台运行不干扰其他操作。

---

## 🚀 快速入门

### 1. 运行前准备
*   **管理员权限**：请务必以**管理员身份运行**本程序，否则无法模拟按键。
*   **游戏设置**：建议将游戏设置为**窗口模式**（或无边框窗口），以获得最佳识别效果。
*   **输入法**：运行前请切换至英文输入法，避免按键冲突。

### 2. 操作流程详解

#### 第一步：建立装备档案 (Equip Tab)
在开始洗炼前，软件需要知道装备在哪里以及属性显示在哪里。
1.  进入 **【装备配置】** 标签页。
2.  点击 **[✚ 新建配置]**，输入一个易于记忆的名字（如“神圣腰带”）。
3.  在下拉列表中选择刚才新建的配置。
4.  点击 **[🎯 重新定位]**，跟随屏幕提示进行**三步校准**：
    *   **步骤 1 (绑定窗口)**：点击游戏窗口使其处于激活状态，按 **空格键** 确认。
    *   **步骤 2 (定位装备)**：将鼠标悬停在游戏背包中的“洗炼目标装备”上，按 **空格键** 确认。
    *   **步骤 3 (框选属性)**：
        1.  将鼠标移至装备属性说明文字的**左上角**，按 **空格键**。
        2.  将鼠标移至装备属性说明文字的**右下角**，按 **空格键**。
    *   *提示：框选区域应包围所有可能的属性文字，但尽量不要包含无关的背景图案或边框。*
5.  定位完成后，软件会自动保存坐标信息。

#### 第二步：制定洗炼规则 (Rule Tab)
告诉软件您想要什么样的属性。
1.  进入 **【规则管理】** 标签页。
2.  点击 **[✚ 新建规则]**，输入规则名称（如“法师神装”）。
3.  点击 **[📝 编辑规则详情]** 打开高级编辑器：
    *   **添加条件组**：点击“新建条件组”。
    *   **设置逻辑**：
        *   **和 (AND)**：组内所有条件必须全部满足。
        *   **数量 (COUNT)**：组内条件至少满足 X 个（例如：3条抗性中至少满足2条）。
    *   **添加具体词条**：输入关键词（如 `全技能`），选择比较符（`>=`），输入数值（`2`）。
4.  保存规则。您也可以点击 **[📥 导入默认库]** 使用系统预设的通用规则。

#### 第三步：全自动洗炼 (Run Tab)
一切准备就绪，开始工作。
1.  进入 **【运行控制】** 标签页。
2.  在左侧选择刚才配置的 **[装备档案]**。
3.  在右侧选择刚才制定的 **[洗炼规则]**。
4.  确保游戏窗口可见且未被遮挡。
5.  点击 **[🚀 开始洗炼]** 按钮，或者按下全局快捷键 **[END]**。
6.  观察日志输出，软件会自动识别属性并判断是否保留。

### 🛑 停止与控制
*   **启动快捷键**：`END` (默认)
*   **停止快捷键**：`HOME` (默认)
*   *提示：您可以在【系统设置】中自定义这两个快捷键。*

---

## 🛠️ 系统设置 (Setting Tab)
*   **调试模式**：开启后，软件会在每次识别时保存截图到 `ocr_debug` 文件夹。如果你发现识别不准，请开启此功能并将截图发送给开发者分析。
*   **快捷键设置**：点击按钮后按下键盘上的任意键，即可更改启动/停止快捷键。

---

## ❓ 常见问题 (FAQ)

**Q: 按下开始键后没有任何反应？**
A: 
1. 检查是否以**管理员身份运行**。
2. 检查快捷键是否被其他软件占用。
3. 尝试在界面上点击[开始洗炼]按钮看是否有反应。

**Q: OCR 识别经常出错，数字识别不对？**
A: 
1. **校准区域**：可能是属性区域框选得太大或太小，包含了边框花纹。请重新定位，尽量只框选文字背景较纯净的区域。
2. **游戏字体**：某些游戏补丁修改了字体可能会导致识别率下降。
3. **分辨率**：过低的游戏分辨率会导致文字模糊，建议适当提高游戏分辨率。

**Q: 洗炼速度太慢/太快？**
A: 目前速度是自动适配的。如果过快导致游戏未响应，请检查电脑性能。如果过慢，可能是 OCR 识别耗时较长（通常在 100-300ms 之间）。

**Q: 软件提示“找不到 tesseract.exe”？**
A: 请确保软件目录下的 `OCR` 文件夹完整，且包含 `tessdata` 数据包。如果是自行编译，请安装 Tesseract 并配置环境变量。

---

**技术支持**: 如果遇到无法解决的问题，请开启[调试模式]，收集 `ocr_debug` 文件夹下的截图，并附上日志文件反馈给开发者。
